{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n// import { getCaptcha, app_register } from \"@/api/app\";\n// import debounce from \"lodash/debounce\";\n// import { mapActions } from \"vuex\";\nexport default {\n  data() {\n    const validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入密码\"));\n      } else {\n        if (this.registerForm.password !== \"\") {\n          this.$refs.registerForm.validateField(\"password1\");\n        }\n\n        callback();\n      }\n    };\n\n    const validatePass2 = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.registerForm.password) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      type: \"login\",\n      flag: false,\n      captcha: \"\",\n      loginForm: {\n        username: \"\",\n        password: \"\",\n        captcha: \"\"\n      },\n      registerForm: {\n        username: \"\",\n        password: \"\",\n        password1: \"\",\n        code: \"\"\n      },\n      loginRules: {\n        username: [{\n          required: true,\n          message: \"请输入用户名\",\n          trigger: \"blur\"\n        }, {\n          min: 4,\n          max: 10,\n          message: \"用户名为4-10位\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          required: true,\n          message: \"请输入密码\",\n          trigger: \"blur\"\n        }, {\n          min: 6,\n          max: 10,\n          message: \"密码为6-10位\",\n          trigger: \"blur\"\n        }],\n        captcha: [{\n          required: true,\n          message: \"请输入验证码\",\n          trigger: \"blur\"\n        }, {\n          min: 4,\n          max: 4,\n          message: \"验证码格式不正确\",\n          trigger: \"blur\"\n        }]\n      },\n      registerRules: {\n        username: [{\n          required: true,\n          message: \"请输入用户名\",\n          trigger: \"blur\"\n        }, {\n          min: 4,\n          max: 10,\n          message: \"用户名为4-10位\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          required: true,\n          message: \"请输入密码\",\n          trigger: \"blur\"\n        }, {\n          min: 6,\n          max: 10,\n          message: \"密码为6-10位\",\n          trigger: \"blur\"\n        }, {\n          validator: validatePass,\n          trigger: \"blur\"\n        }],\n        password1: [{\n          required: true,\n          message: \"请再次输入密码\",\n          trigger: \"blur\"\n        }, {\n          validator: validatePass2,\n          trigger: \"blur\"\n        }],\n        code: [{\n          required: true,\n          message: \"请输入邀请码\",\n          trigger: \"blur\"\n        }, {\n          min: 8,\n          max: 8,\n          message: \"邀请码格式不正确\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n\n  mounted() {\n    this.initData();\n  },\n\n  methods: {\n    // ...mapActions([\"LOGIN\"]),\n    initData() {\n      getCaptcha().then(res => {\n        this.captcha = this.resetSvg(res.data);\n      });\n    },\n\n    initForm() {\n      this.loginForm = {\n        username: \"\",\n        password: \"\",\n        captcha: \"\"\n      };\n      this.registerForm = {\n        username: \"\",\n        password: \"\",\n        password1: \"\",\n        code: \"\"\n      };\n    },\n\n    refreshCaptcha: debounce(function () {\n      getCaptcha().then(res => {\n        this.captcha = this.resetSvg(res.data);\n      });\n    }, 500),\n\n    resetSvg(svg) {\n      svg = svg.replace('width=\"100\"', 'width=\"100%\"');\n      svg = svg.replace('height=\"40\"', 'height=\"100%\"');\n      return svg;\n    },\n\n    changeType(type) {\n      if (this.flag) return;\n      this.type = type;\n      this.flag = true;\n      this.initForm();\n      this.$nextTick(() => {\n        this.resetForm(type + \"Form\");\n      });\n      setTimeout(() => {\n        this.flag = false;\n      }, 2000);\n    },\n\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          // 后面封装到vuex中\n          if (formName === \"registerForm\") {\n            const data = { ...this.registerForm\n            };\n            delete data.password1;\n            app_register(data).then(() => {\n              // 注册成功 跳到登陆\n              this.changeType(\"login\");\n            });\n          } else {\n            //   将登陆方法 放到vuex中管理\n            this.LOGIN(this.loginForm).then(() => {\n              // 登陆成功 跳转到首页\n              this.$router.push(\"/\");\n            });\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    }\n\n  }\n};","map":{"version":3,"mappings":";AA8GA;AACA;AACA;AACA;EACAA;IACA;MACA;QACAC;MACA,CAFA,MAEA;QACA;UACA;QACA;;QACAA;MACA;IACA,CATA;;IAUA;MACA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;IACA,CARA;;IASA;MACAC,aADA;MAEAC,WAFA;MAGAC,WAHA;MAIAC;QACAC,YADA;QAEAC,YAFA;QAGAH;MAHA,CAJA;MASAI;QACAF,YADA;QAEAC,YAFA;QAGAE,aAHA;QAIAC;MAJA,CATA;MAeAC;QACAL,WACA;UACAM,cADA;UAEAC,iBAFA;UAGAC;QAHA,CADA,EAMA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CANA,CADA;QASAP,WACA;UACAK,cADA;UAEAC,gBAFA;UAGAC;QAHA,CADA,EAMA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CANA,CATA;QAiBAV,UACA;UAAAQ;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CAFA;MAjBA,CAfA;MAqCAG;QACAX,WACA;UACAM,cADA;UAEAC,iBAFA;UAGAC;QAHA,CADA,EAMA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CANA,CADA;QASAP,WACA;UACAK,cADA;UAEAC,gBAFA;UAGAC;QAHA,CADA,EAMA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CANA,EAOA;UAAAI;UAAAJ;QAAA,CAPA,CATA;QAkBAL,YACA;UACAG,cADA;UAEAC,kBAFA;UAGAC;QAHA,CADA,EAMA;UAAAI;UAAAJ;QAAA,CANA,CAlBA;QA0BAJ,OACA;UAAAE;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CAFA;MA1BA;IArCA;EAqEA,CA1FA;;EA2FAK;IACA;EACA,CA7FA;;EA8FAC;IACA;IACAC;MACAC;QACA;MACA,CAFA;IAGA,CANA;;IAOAC;MACA;QACAjB,YADA;QAEAC,YAFA;QAGAH;MAHA;MAKA;QACAE,YADA;QAEAC,YAFA;QAGAE,aAHA;QAIAC;MAJA;IAMA,CAnBA;;IAoBAc;MACAF;QACA;MACA,CAFA;IAGA,CAJA,EAIA,GAJA,CApBA;;IAyBAG;MACAC;MACAA;MACA;IACA,CA7BA;;IA8BAC;MACA;MACA;MACA;MACA;MACA;QACA;MACA,CAFA;MAGAC;QACA;MACA,CAFA,EAEA,IAFA;IAGA,CAzCA;;IA0CAC;MACA;QACA;UACA;UACA;YACA;YAAA;YACA;YACAC;cACA;cACA;YACA,CAHA;UAIA,CAPA,MAOA;YACA;YACA;cACA;cACA;YACA,CAHA;UAIA;QACA,CAhBA,MAgBA;UACAC;UACA;QACA;MACA,CArBA;IAsBA,CAjEA;;IAkEAC;MACA;IACA;;EApEA;AA9FA","names":["data","callback","type","flag","captcha","loginForm","username","password","registerForm","password1","code","loginRules","required","message","trigger","min","max","registerRules","validator","mounted","methods","initData","getCaptcha","initForm","refreshCaptcha","resetSvg","svg","changeType","setTimeout","submitForm","app_register","console","resetForm"],"sourceRoot":"src","sources":["App.vue"],"sourcesContent":["<template>\n  <!-- 登陆页 -->\n  <div class=\"login-wrap\">\n    <div class=\"box\">\n      <div\n        class=\"to-register\"\n        :class=\"type === 'login' ? 'show-register' : 'hide-register'\"\n      >\n        <h1>Don't have an account ?</h1>\n        <el-button @click=\"changeType('register')\">SIGN UP</el-button>\n      </div>\n      <div\n        class=\"to-login\"\n        :class=\"type === 'register' ? 'show-login' : 'hide-login'\"\n      >\n        <h1>Already have an account ?</h1>\n        <div>\n          <el-button @click=\"changeType('login')\">SIGN IN</el-button>\n        </div>\n      </div>\n      <div class=\"form\" :class=\"[type, flag && type + '-move']\">\n        <el-form\n          v-if=\"type === 'login'\"\n          class=\"form-box\"\n          ref=\"loginForm\"\n          :rules=\"loginRules\"\n          :model=\"loginForm\"\n          key=\"login\"\n        >\n          <el-form-item prop=\"username\">\n            <el-input\n              v-model=\"loginForm.username\"\n              placeholder=\"用户名\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item prop=\"password\">\n            <el-input\n              v-model=\"loginForm.password\"\n              placeholder=\"密码\"\n              show-password\n            ></el-input>\n          </el-form-item>\n          <el-form-item prop=\"captcha\">\n            <el-row>\n              <el-col :span=\"18\">\n                <el-input\n                  v-model=\"loginForm.captcha\"\n                  :maxlength=\"4\"\n                  placeholder=\"验证码\"\n                ></el-input>\n              </el-col>\n              <el-col :span=\"6\">\n                <div\n                  class=\"captcha\"\n                  v-html=\"captcha\"\n                  @click=\"refreshCaptcha\"\n                ></div>\n              </el-col>\n            </el-row>\n          </el-form-item>\n          <el-form-item>\n            <el-button @click=\"submitForm('loginForm')\">登陆</el-button>\n          </el-form-item>\n        </el-form>\n        <el-form\n          v-if=\"type === 'register'\"\n          class=\"form-box\"\n          ref=\"registerForm\"\n          :rules=\"registerRules\"\n          :model=\"registerForm\"\n          key=\"register\"\n        >\n          <el-form-item prop=\"username\">\n            <el-input\n              v-model=\"registerForm.username\"\n              placeholder=\"用户名\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item prop=\"password\">\n            <el-input\n              v-model=\"registerForm.password\"\n              show-password\n              placeholder=\"密码\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item prop=\"password1\">\n            <el-input\n              v-model=\"registerForm.password1\"\n              show-password\n              placeholder=\"确认密码\"\n            ></el-input>\n          </el-form-item>\n          <!-- 邀请码为8位 -->\n          <el-form-item prop=\"code\">\n            <el-input\n              v-model=\"registerForm.code\"\n              :maxlength=\"8\"\n              placeholder=\"邀请码\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item>\n            <el-button @click=\"submitForm('registerForm')\">注册</el-button>\n          </el-form-item>\n        </el-form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// import { getCaptcha, app_register } from \"@/api/app\";\n// import debounce from \"lodash/debounce\";\n// import { mapActions } from \"vuex\";\nexport default {\n  data() {\n    const validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入密码\"));\n      } else {\n        if (this.registerForm.password !== \"\") {\n          this.$refs.registerForm.validateField(\"password1\");\n        }\n        callback();\n      }\n    };\n    const validatePass2 = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.registerForm.password) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      type: \"login\",\n      flag: false,\n      captcha: \"\",\n      loginForm: {\n        username: \"\",\n        password: \"\",\n        captcha: \"\",\n      },\n      registerForm: {\n        username: \"\",\n        password: \"\",\n        password1: \"\",\n        code: \"\",\n      },\n      loginRules: {\n        username: [\n          {\n            required: true,\n            message: \"请输入用户名\",\n            trigger: \"blur\",\n          },\n          { min: 4, max: 10, message: \"用户名为4-10位\", trigger: \"blur\" },\n        ],\n        password: [\n          {\n            required: true,\n            message: \"请输入密码\",\n            trigger: \"blur\",\n          },\n          { min: 6, max: 10, message: \"密码为6-10位\", trigger: \"blur\" },\n        ],\n        captcha: [\n          { required: true, message: \"请输入验证码\", trigger: \"blur\" },\n          { min: 4, max: 4, message: \"验证码格式不正确\", trigger: \"blur\" },\n        ],\n      },\n      registerRules: {\n        username: [\n          {\n            required: true,\n            message: \"请输入用户名\",\n            trigger: \"blur\",\n          },\n          { min: 4, max: 10, message: \"用户名为4-10位\", trigger: \"blur\" },\n        ],\n        password: [\n          {\n            required: true,\n            message: \"请输入密码\",\n            trigger: \"blur\",\n          },\n          { min: 6, max: 10, message: \"密码为6-10位\", trigger: \"blur\" },\n          { validator: validatePass, trigger: \"blur\" },\n        ],\n        password1: [\n          {\n            required: true,\n            message: \"请再次输入密码\",\n            trigger: \"blur\",\n          },\n          { validator: validatePass2, trigger: \"blur\" },\n        ],\n        code: [\n          { required: true, message: \"请输入邀请码\", trigger: \"blur\" },\n          { min: 8, max: 8, message: \"邀请码格式不正确\", trigger: \"blur\" },\n        ],\n      },\n    };\n  },\n  mounted() {\n    this.initData();\n  },\n  methods: {\n    // ...mapActions([\"LOGIN\"]),\n    initData() {\n      getCaptcha().then((res) => {\n        this.captcha = this.resetSvg(res.data);\n      });\n    },\n    initForm() {\n      this.loginForm = {\n        username: \"\",\n        password: \"\",\n        captcha: \"\",\n      };\n      this.registerForm = {\n        username: \"\",\n        password: \"\",\n        password1: \"\",\n        code: \"\",\n      };\n    },\n    refreshCaptcha: debounce(function () {\n      getCaptcha().then((res) => {\n        this.captcha = this.resetSvg(res.data);\n      });\n    }, 500),\n    resetSvg(svg) {\n      svg = svg.replace('width=\"100\"', 'width=\"100%\"');\n      svg = svg.replace('height=\"40\"', 'height=\"100%\"');\n      return svg;\n    },\n    changeType(type) {\n      if (this.flag) return;\n      this.type = type;\n      this.flag = true;\n      this.initForm();\n      this.$nextTick(() => {\n        this.resetForm(type + \"Form\");\n      });\n      setTimeout(() => {\n        this.flag = false;\n      }, 2000);\n    },\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          // 后面封装到vuex中\n          if (formName === \"registerForm\") {\n            const data = { ...this.registerForm };\n            delete data.password1;\n            app_register(data).then(() => {\n              // 注册成功 跳到登陆\n              this.changeType(\"login\");\n            });\n          } else {\n            //   将登陆方法 放到vuex中管理\n            this.LOGIN(this.loginForm).then(() => {\n              // 登陆成功 跳转到首页\n              this.$router.push(\"/\");\n            });\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.login-wrap {\n  background: #cccccc;\n  height: 100vh;\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  .box {\n    height: 300px;\n    width: 80vw;\n    background: #3b3b3b;\n    position: relative;\n    .to-register {\n      position: absolute;\n      top: 50%;\n      left: 20px;\n      transform: translate(0, -50%);\n      &.show-register {\n        opacity: 1;\n        animation: show 2s ease;\n      }\n      &.hide-register {\n        opacity: 0;\n        animation: hide 2s ease;\n      }\n    }\n    .to-login {\n      position: absolute;\n      top: 50%;\n      right: 20px;\n      transform: translate(0, -50%);\n      > div {\n        text-align: right;\n      }\n      &.show-login {\n        opacity: 1;\n        animation: show 2s ease;\n      }\n      &.hide-login {\n        opacity: 0;\n        animation: hide 2s ease;\n      }\n    }\n    .form {\n      position: absolute;\n      top: -50px;\n      height: 400px;\n      width: 400px;\n      background: #fff;\n      display: flex;\n      align-items: center;\n      padding: 30px;\n      box-sizing: border-box;\n      .form-box {\n        width: 100%;\n      }\n      &.login {\n        left: calc(80vw - 50px - 400px);\n      }\n      &.register {\n        left: 50px;\n      }\n      &.login-move {\n        animation: move-to-login 2s ease;\n      }\n\n      &.register-move {\n        animation: move-to-register 2s ease;\n      }\n      .captcha {\n        cursor: pointer;\n        height: 40px;\n        width: 100px;\n      }\n    }\n  }\n}\n\n@keyframes move-to-login {\n  0% {\n    left: 50px;\n  }\n  100% {\n    left: calc(80vw - 50px - 400px);\n  }\n}\n\n@keyframes move-to-register {\n  0% {\n    left: calc(80vw - 50px - 400px);\n  }\n  100% {\n    left: 50px;\n  }\n}\n\n@keyframes show {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@keyframes hide {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n</style>\n\n"]},"metadata":{},"sourceType":"module"}